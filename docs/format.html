---

title: Formatação 


keywords: fastai
sidebar: home_sidebar

summary: "Este módulo possui funções auxiliares de formatação dos dados das várias fontes."
description: "Este módulo possui funções auxiliares de formatação dos dados das várias fontes."
nb_path: "nbs\format.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\format.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="c1"># Insert in Path Project Directory</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="row2dict" class="doc_header"><code>row2dict</code><a href="anateldb/format.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>row2dict</code>(<strong><code>row</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Receives a json row and return the dictionary from it</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>row</code></strong></td>
<td><code>dict</code></td>
<td></td>
<td><em>No Content</em></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dict2cols" class="doc_header"><code>dict2cols</code><a href="anateldb/format.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dict2cols</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>reject</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>()</code></em>)</p>
</blockquote>
<p>Recebe um dataframe com dicionários nas células e extrai os dicionários como colunas
Opcionalmente ignora e exclue as colunas em reject</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_plano_basico" class="doc_header"><code>parse_plano_basico</code><a href="anateldb/format.py#L46" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_plano_basico</code>(<strong><code>row</code></strong>:<code>dict</code>, <strong><code>cols</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>('id', 'municipio', 'frequencia', 'classe', 'servico', 'entidade', 'latitude', 'longitude', 'uf', 'status', 'cnpj', 'fistel')</code></em>)</p>
</blockquote>
<p>Receives a json row and filter the column in <code>cols</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scrape_dataframe" class="doc_header"><code>scrape_dataframe</code><a href="anateldb/format.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scrape_dataframe</code>(<strong><code>id_list</code></strong>:<code>Iterable</code>[<code>str</code>])</p>
</blockquote>
<p>Receives a list of ids and returns a dataframe with the data from web scraping the MOSAICO page</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="input_coordenates" class="doc_header"><code>input_coordenates</code><a href="anateldb/format.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>input_coordenates</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>pasta</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>])</p>
</blockquote>
<p>Input the NA's in Coordinates with those of the cities</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_bw" class="doc_header"><code>parse_bw</code><a href="anateldb/format.py#L134" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_bw</code>(<strong><code>bw</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Parse the bandwidth string</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Otimiza%C3%A7%C3%A3o-dos-Tipos-de-dados">Otimiza&#231;&#227;o dos Tipos de dados<a class="anchor-link" href="#Otimiza%C3%A7%C3%A3o-dos-Tipos-de-dados"> </a></h2><p>A serem criados dataframes, normalmente a tipo de data é aquele com maior resolução possível, nem sempre isso é necessário, os arquivos de espectro mesmo possuem somente uma casa decimal, portanto um <code>float16</code> já é suficiente para armazená-los. As funções a seguir fazem essa otimização</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Code below borrowed from <a href="https://medium.com/bigdatarepublic/advanced-pandas-optimize-speed-and-memory-a654b53be6c2">https://medium.com/bigdatarepublic/advanced-pandas-optimize-speed-and-memory-a654b53be6c2</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="optimize_floats" class="doc_header"><code>optimize_floats</code><a href="anateldb/format.py#L146" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>optimize_floats</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>exclude</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Optimize the floats in the dataframe to reduce the memory usage</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="optimize_ints" class="doc_header"><code>optimize_ints</code><a href="anateldb/format.py#L154" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>optimize_ints</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>exclude</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Optimize the ints in the dataframe to reduce the memory usage</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="optimize_objects" class="doc_header"><code>optimize_objects</code><a href="anateldb/format.py#L162" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>optimize_objects</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>datetime_features</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>None</code></em>, <strong><code>exclude</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Optimize the objects in the dataframe to category | string to reduce the memory usage</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df_optimize" class="doc_header"><code>df_optimize</code><a href="anateldb/format.py#L188" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df_optimize</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>datetime_features</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>None</code></em>, <strong><code>exclude</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Optimize the data types in dataframe to reduce the memory usage</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="format_types" class="doc_header"><code>format_types</code><a href="anateldb/format.py#L202" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>format_types</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>stem</code></strong>:<code>str</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Convert the columns of a dataframe to optimized types</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>df</code></strong></td>
<td><code>DataFrame</code></td>
<td></td>
<td>raw DataFrame to format</td>
</tr>
<tr>
<td><strong><code>stem</code></strong></td>
<td><code>str</code></td>
<td><code>None</code></td>
<td>identifier for format specific conversions</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted constants.ipynb.
Converted filter.ipynb.
Converted format.ipynb.
Converted index.ipynb.
Converted merge.ipynb.
Converted query.ipynb.
Converted read.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

