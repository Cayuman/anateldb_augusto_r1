---

title: Queries


keywords: fastai
sidebar: home_sidebar

summary: "Este módulo executa as queries sql / MongoDB necessárias para baixar os dados do STEL, RADCOM e MOSAICO"
description: "Este módulo executa as queries sql / MongoDB necessárias para baixar os dados do STEL, RADCOM e MOSAICO"
nb_path: "queries.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: queries.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Otimiza&#231;&#227;o-dos-Tipos-de-dados">Otimiza&#231;&#227;o dos Tipos de dados<a class="anchor-link" href="#Otimiza&#231;&#227;o-dos-Tipos-de-dados"> </a></h2><p>A serem criados dataframes, normalmente a tipo de data é aquele com maior resolução possível, nem sempre isso é necessário, os arquivos de espectro mesmo possuem somente uma casa decimal, portanto um <code>float16</code> já é suficiente para armazená-los. As funções a seguir fazem essa otimização</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Code below borrowed from <a href="https://medium.com/bigdatarepublic/advanced-pandas-optimize-speed-and-memory-a654b53be6c2">https://medium.com/bigdatarepublic/advanced-pandas-optimize-speed-and-memory-a654b53be6c2</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="optimize_floats" class="doc_header"><code>optimize_floats</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L216" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>optimize_floats</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>exclude</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="optimize_ints" class="doc_header"><code>optimize_ints</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L223" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>optimize_ints</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="optimize_objects" class="doc_header"><code>optimize_objects</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L229" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>optimize_objects</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>datetime_features</code></strong>:<code>List</code>[<code>str</code>])</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df_optimize" class="doc_header"><code>df_optimize</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L241" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df_optimize</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>datetime_features</code></strong>:<code>List</code>[<code>str</code>]=<em><code>[]</code></em>, <strong><code>exclude</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="connect_db" class="doc_header"><code>connect_db</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L245" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>connect_db</code>()</p>
</blockquote>
<p>Conecta ao Banco ANATELBDRO01 e retorna o 'cursor' (iterador) do Banco pronto para fazer iterações</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_connection</span><span class="p">():</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">connect_db</span><span class="p">()</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="p">(</span><span class="n">RADCOM</span><span class="p">,</span> <span class="n">STEL</span><span class="p">):</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()),</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Row</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="row2dict" class="doc_header"><code>row2dict</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L258" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>row2dict</code>(<strong><code>row</code></strong>)</p>
</blockquote>
<p>Receives a json row and return the dictionary from it</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dict2cols" class="doc_header"><code>dict2cols</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L263" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dict2cols</code>(<strong><code>df</code></strong>, <strong><code>reject</code></strong>=<em><code>()</code></em>)</p>
</blockquote>
<p>Recebe um dataframe com dicionários nas células e extrai os dicionários como colunas
Opcionalmente ignora e exclue as colunas em reject</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_plano_basico" class="doc_header"><code>parse_plano_basico</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L281" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_plano_basico</code>(<strong><code>row</code></strong>, <strong><code>cols</code></strong>=<em><code>('id', 'municipio', 'frequencia', 'classe', 'servico', 'entidade', 'latitude', 'longitude', 'uf', 'status', 'cnpj', 'fistel', 'canal')</code></em>)</p>
</blockquote>
<p>Receives a json row and filter the column in <code>cols</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scrape_dataframe" class="doc_header"><code>scrape_dataframe</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L286" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scrape_dataframe</code>(<strong><code>id_list</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_stel" class="doc_header"><code>read_stel</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L297" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_stel</code>(<strong><code>pasta</code></strong>, <strong><code>update</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Lê o banco de dados salvo localmente do STEL. Opcionalmente o atualiza pelo Banco de Dados ANATELBDRO01.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_radcom" class="doc_header"><code>read_radcom</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L318" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_radcom</code>(<strong><code>pasta</code></strong>, <strong><code>update</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Lê o banco de dados salvo localmente de RADCOM. Opcionalmente o atualiza pelo Banco de Dados ANATELBDRO01.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_estações" class="doc_header"><code>read_estações</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L339" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_estações</code>(<strong><code>path</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_plano_basico" class="doc_header"><code>read_plano_basico</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L373" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_plano_basico</code>(<strong><code>path</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_historico" class="doc_header"><code>read_historico</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L395" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_historico</code>(<strong><code>path</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_mosaico" class="doc_header"><code>read_mosaico</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L414" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_mosaico</code>(<strong><code>pasta</code></strong>, <strong><code>update</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_merge" class="doc_header"><code>clean_merge</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L422" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_merge</code>(<strong><code>pasta</code></strong>, <strong><code>df</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="update_radcom" class="doc_header"><code>update_radcom</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L518" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>update_radcom</code>(<strong><code>folder</code></strong>)</p>
</blockquote>
<p>Update the Radcom File querying the Database</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="update_stel" class="doc_header"><code>update_stel</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L534" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>update_stel</code>(<strong><code>folder</code></strong>)</p>
</blockquote>
<p>Update the Stel File querying the Database</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="update_mosaico" class="doc_header"><code>update_mosaico</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/query.py#L551" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>update_mosaico</code>(<strong><code>pasta</code></strong>)</p>
</blockquote>
<p>Update the Mosaico File by downloading the zipped xml file from the Spectrum E Web page</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">update_mosaico</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\OneDrive - ANATEL\BaseDados&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">Consolidando as bases de dados...</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Kbô 🧛
</pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df.head()</span>

<span class="c1"># radcom = read_radcom(r&#39;D:\OneDrive - ANATEL\BaseDados&#39;)</span>

<span class="c1"># radcom.info()</span>

<span class="c1"># stel = read_stel(r&#39;D:\OneDrive - ANATEL\BaseDados&#39;)</span>

<span class="c1"># stel.info()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df.to_feather(r&#39;D:\OneDrive - ANATEL\BaseDados\mosaico.fth&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># r = requests.get(&#39;https://anatel365-my.sharepoint.com/:x:/g/personal/rsilva_anatel_gov_br/ESjSacOqe3xEpodgo9-cRW0ByQD_7fIn_NVpP1A6gz7V0Q?download=1&#39;)</span>

<span class="c1"># r</span>

<span class="c1"># p = Path(r&#39;D:\OneDrive - ANATEL\BaseDados\AnatelDB.xlsx&#39;)</span>

<span class="c1"># p.write_bytes(r.content)</span>

<span class="c1"># d = requests.get(&#39;https://anatel365-my.sharepoint.com/:x:/g/personal/rsilva_anatel_gov_br/ESjSacOqe3xEpodgo9-cRW0BCaLnzQUHFTH8vdkH7sZwkg?download=1&#39;)</span>

<span class="c1"># p = Path(r&#39;D:\OneDrive - ANATEL\BaseDados\Teste.xlsx&#39;)</span>

<span class="c1"># p.write_bytes(d.content)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stel</span> <span class="o">=</span> <span class="n">read_stel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\OneDrive - ANATEL\BaseDados&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stel</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequência</th>
      <th>Unidade</th>
      <th>Serviço</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Número da Estação</th>
      <th>Município</th>
      <th>UF</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>CNPJ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34.779999</td>
      <td>MHz</td>
      <td>078</td>
      <td>ASSOCIACAO DOS MOTORISTAS AUTON RADIO TAXI COM...</td>
      <td>02031913239</td>
      <td>3939987</td>
      <td>São Paulo</td>
      <td>SP</td>
      <td>-23.569084</td>
      <td>-46.707279</td>
      <td>64019656000139</td>
    </tr>
    <tr>
      <th>1</th>
      <td>34.840000</td>
      <td>MHz</td>
      <td>078</td>
      <td>ASSOCIACAO DOS TAXISTAS E RADIO TAXIS MUNIC SA...</td>
      <td>02033423808</td>
      <td>690190999</td>
      <td>São Paulo</td>
      <td>SP</td>
      <td>-23.474445</td>
      <td>-46.656387</td>
      <td>67644641000150</td>
    </tr>
    <tr>
      <th>2</th>
      <td>35.020000</td>
      <td>MHz</td>
      <td>033</td>
      <td>EXPO-TAXI COMUM RADIO LTDA - ME</td>
      <td>50010393633</td>
      <td>577100645</td>
      <td>São Paulo</td>
      <td>SP</td>
      <td>-23.416111</td>
      <td>-46.706944</td>
      <td>02107071000113</td>
    </tr>
    <tr>
      <th>3</th>
      <td>36.439999</td>
      <td>MHz</td>
      <td>019</td>
      <td>INDUSCAL-INDUSTRIA DE CALCARIO LTDA</td>
      <td>50000771481</td>
      <td>1938380</td>
      <td>Riachão</td>
      <td>MA</td>
      <td>-7.520833</td>
      <td>-46.141666</td>
      <td>05746748000151</td>
    </tr>
    <tr>
      <th>4</th>
      <td>38.020000</td>
      <td>MHz</td>
      <td>019</td>
      <td>POLICIA MILITAR</td>
      <td>13020046890</td>
      <td>1619349</td>
      <td>Goiânia</td>
      <td>GO</td>
      <td>-16.672501</td>
      <td>-49.258057</td>
      <td>01409671000173</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>403604</th>
      <td>22807.000000</td>
      <td>kHz</td>
      <td>064</td>
      <td>CLARO S.A.</td>
      <td>01020422092</td>
      <td>895156</td>
      <td>Rio de Janeiro</td>
      <td>RJ</td>
      <td>-22.965000</td>
      <td>-43.673332</td>
      <td>40432544000147</td>
    </tr>
    <tr>
      <th>403605</th>
      <td>23113.000000</td>
      <td>kHz</td>
      <td>019</td>
      <td>RAFT TECNOLOGIES BRAZIL SISTEMAS DE TECNOLOGIA...</td>
      <td>50411558609</td>
      <td>1000352878</td>
      <td>Santana de Parnaíba</td>
      <td>SP</td>
      <td>-23.467583</td>
      <td>-46.862110</td>
      <td>17196674000106</td>
    </tr>
    <tr>
      <th>403606</th>
      <td>25242.000000</td>
      <td>kHz</td>
      <td>019</td>
      <td>EMBAIXADA DA REPUBLICA TCHECA</td>
      <td>50000906590</td>
      <td>5050111</td>
      <td>Brasília</td>
      <td>DF</td>
      <td>-15.819445</td>
      <td>-47.880554</td>
      <td>00000000000000</td>
    </tr>
    <tr>
      <th>403607</th>
      <td>26100.500000</td>
      <td>kHz</td>
      <td>064</td>
      <td>CLARO S.A.</td>
      <td>01020422092</td>
      <td>895180</td>
      <td>Recife</td>
      <td>PE</td>
      <td>-8.051666</td>
      <td>-34.929443</td>
      <td>40432544000147</td>
    </tr>
    <tr>
      <th>403608</th>
      <td>26720.000000</td>
      <td>kHz</td>
      <td>079</td>
      <td>TELE TAXI CIDADE LTDA</td>
      <td>03020216710</td>
      <td>71366</td>
      <td>Porto Alegre</td>
      <td>RS</td>
      <td>-30.063889</td>
      <td>-51.200001</td>
      <td>90068602000173</td>
    </tr>
  </tbody>
</table>
<p>403609 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stel</span><span class="o">.</span><span class="n">Serviço</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>019    344955
099     12965
604     11508
011      9127
053      6163
125      5600
035      4639
046      2004
507      1987
124      1407
078      1070
017       708
079       573
033       421
064       322
108       109
012        46
132         5
Name: Serviço, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stel</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">stel</span><span class="o">.</span><span class="n">Serviço</span> <span class="o">==</span> <span class="s1">&#39;507&#39;</span><span class="p">,</span> <span class="s1">&#39;Entidade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>COMANDO DA AERONAUTICA                              1112
PETROLEO BRASILEIRO S A PETROBRAS                    209
EMBRAER S.A.                                         126
AZUL LINHAS AEREAS BRASILEIRAS S.A                   123
GOL LINHAS AEREAS S.A.                                67
                                                    ... 
EDITORA MODERNA LTDA                                   0
EDIVALDO FRANCISCO MENDES                              0
EDIVAN ANTONIO ZAVARISI                                0
EDIVAN APARECIDO MOYA ARTIOLI                          0
ÔMEGA SEGURANÇA E VIGILÂNCIA PATRIMONIAL LTDA ME       0
Name: Entidade, Length: 12929, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

