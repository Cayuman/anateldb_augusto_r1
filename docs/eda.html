---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "eda.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: eda.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_read_xml</span> <span class="k">as</span> <span class="nn">pdx</span>
<span class="kn">from</span> <span class="nn">pandas_profiling</span> <span class="kn">import</span> <span class="n">ProfileReport</span>
<span class="kn">from</span> <span class="nn">anateldb.parser</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">anateldb.query</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SIGLAS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Acre&quot;</span> <span class="p">:</span> <span class="s2">&quot;AC&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Alagoas&quot;</span> <span class="p">:</span> <span class="s2">&quot;AL&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Amapá&quot;</span><span class="p">:</span> <span class="s2">&quot;AP&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Amazonas&quot;</span><span class="p">:</span><span class="s2">&quot;AM&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Bahia&quot;</span><span class="p">:</span><span class="s2">&quot;BA&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Ceará&quot;</span><span class="p">:</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Espírito Santo&quot;</span><span class="p">:</span><span class="s2">&quot;ES&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Goiás&quot;</span><span class="p">:</span><span class="s2">&quot;GO&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Maranhão&quot;</span><span class="p">:</span><span class="s2">&quot;MA&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Mato Grosso&quot;</span><span class="p">:</span><span class="s2">&quot;MT&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Mato Grosso do Sul&quot;</span><span class="p">:</span><span class="s2">&quot;MS&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Minas Gerais&quot;</span><span class="p">:</span> <span class="s2">&quot;MG&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Pará&quot;</span><span class="p">:</span> <span class="s2">&quot;PA&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Paraíba&quot;</span><span class="p">:</span><span class="s2">&quot;PB&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Paraná&quot;</span><span class="p">:</span><span class="s2">&quot;PR&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Pernambuco&quot;</span><span class="p">:</span><span class="s2">&quot;PE&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Piauí&quot;</span><span class="p">:</span><span class="s2">&quot;PI&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Rio de Janeiro&quot;</span><span class="p">:</span><span class="s2">&quot;RJ&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Rio Grande do Norte&quot;</span><span class="p">:</span><span class="s2">&quot;RN&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Rio Grande do Sul&quot;</span><span class="p">:</span><span class="s2">&quot;RS&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Rondônia&quot;</span><span class="p">:</span><span class="s2">&quot;RO&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Roraima&quot;</span><span class="p">:</span><span class="s2">&quot;RR&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Santa Catarina&quot;</span><span class="p">:</span><span class="s2">&quot;SC&quot;</span><span class="p">,</span>
          <span class="s2">&quot;São Paulo&quot;</span><span class="p">:</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Sergipe&quot;</span><span class="p">:</span><span class="s2">&quot;SE&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Tocantins&quot;</span><span class="p">:</span><span class="s2">&quot;TO&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Distrito Federal&quot;</span><span class="p">:</span><span class="s2">&quot;DF&quot;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pb</span> <span class="o">=</span> <span class="n">read_plano_basico</span><span class="p">(</span><span class="s1">&#39;D:\OneDrive - ANATEL\GR01FI3\BaseDados\plano_basico.zip&#39;</span><span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Serviço</th>
      <th>Status</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Município</th>
      <th>UF</th>
      <th>Id</th>
      <th>CNPJ</th>
      <th>Frequência</th>
      <th>Classe</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Canal</th>
      <th>País</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>45448</th>
      <td>FM</td>
      <td>FM-AT-01</td>
      <td>SISTEMA TRANSRIO DE COMUNICACAO LTDA</td>
      <td>01008010561</td>
      <td>Rio de Janeiro</td>
      <td>RJ</td>
      <td>603e93f71f151</td>
      <td>30913990000110</td>
      <td>105,1</td>
      <td>E1</td>
      <td>-22,946944444444</td>
      <td>-43,219444444444</td>
      <td>286</td>
      <td>BRA</td>
    </tr>
    <tr>
      <th>45449</th>
      <td>RTV</td>
      <td>TV-AT-01</td>
      <td>REDE DE COMUNICACAO CIDADE LTDA</td>
      <td>50400718928</td>
      <td>Ji-Paraná</td>
      <td>RO</td>
      <td>603e97b38612d</td>
      <td>34459933000163</td>
      <td>177</td>
      <td>C</td>
      <td>-10,885277777778</td>
      <td>-61,951666666667</td>
      <td>7</td>
      <td>BRA</td>
    </tr>
    <tr>
      <th>45450</th>
      <td>RTVD</td>
      <td>TV-AT-01</td>
      <td>FUNDACAO JOAO PAULO II</td>
      <td>50409270024</td>
      <td>Cuiabá</td>
      <td>MT</td>
      <td>603e9df677686</td>
      <td>50016039000175</td>
      <td>593</td>
      <td>A</td>
      <td>-15,585278</td>
      <td>-56,081944</td>
      <td>34</td>
      <td>BRA</td>
    </tr>
    <tr>
      <th>45451</th>
      <td>RTVD</td>
      <td>TV-AT-01</td>
      <td>TELEVISAO CACHOEIRA DO SUL LTDA</td>
      <td>50416280250</td>
      <td>Santo Antônio da Patrulha</td>
      <td>RS</td>
      <td>603eb8b8b773f</td>
      <td>89784037000161</td>
      <td>623</td>
      <td>C</td>
      <td>-29,8175</td>
      <td>-50,519722222222</td>
      <td>39</td>
      <td>BRA</td>
    </tr>
    <tr>
      <th>45452</th>
      <td>FM</td>
      <td>FM-AT-01</td>
      <td>BARRINHA COMUNICACOES LTDA</td>
      <td>50406330921</td>
      <td>Barrinha</td>
      <td>SP</td>
      <td>603ec1c290774</td>
      <td>05009032000171</td>
      <td>95,5</td>
      <td>C</td>
      <td>-21,193611111111</td>
      <td>-48,163888888889</td>
      <td>238</td>
      <td>BRA</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># pb_profile</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">es</span> <span class="o">=</span> <span class="n">read_estações</span><span class="p">(</span><span class="s1">&#39;D:\OneDrive - ANATEL\GR01FI3\BaseDados\estações.zip&#39;</span><span class="p">)</span>
<span class="n">es</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Serviço</th>
      <th>Status</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Município</th>
      <th>UF</th>
      <th>Id</th>
      <th>Número da Estação</th>
      <th>CNPJ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28012</th>
      <td>RTVD</td>
      <td>TV-C2</td>
      <td>M. V. L - COMMUNICARE TELECOMUNICACOES LTDA</td>
      <td>50419656170</td>
      <td>Parauapebas</td>
      <td>PA</td>
      <td>5f2068e65ace5</td>
      <td></td>
      <td>12071310000186</td>
    </tr>
    <tr>
      <th>28013</th>
      <td>RTVD</td>
      <td>TV-C1</td>
      <td>MERCES COMUNICACOES LTDA</td>
      <td>50419663118</td>
      <td>Delmiro Gouveia</td>
      <td>AL</td>
      <td>5f218fcfb0d84</td>
      <td></td>
      <td>11322505000199</td>
    </tr>
    <tr>
      <th>28014</th>
      <td>RTVD</td>
      <td>TV-C1</td>
      <td>FUNDACAO EDUCACIONAL E CULTURAL DE IPANEMA</td>
      <td>50433856696</td>
      <td>Sabará</td>
      <td>MG</td>
      <td>5f32c1c918e6b</td>
      <td></td>
      <td>04608796000110</td>
    </tr>
    <tr>
      <th>28015</th>
      <td>FM</td>
      <td>FM-C2</td>
      <td>RADIO ITAPIRANGA LTDA</td>
      <td>50433860456</td>
      <td>Itapiranga</td>
      <td>SC</td>
      <td>5f68d432841a5</td>
      <td></td>
      <td>84375872000124</td>
    </tr>
    <tr>
      <th>28016</th>
      <td>FM</td>
      <td>FM-C1</td>
      <td>EMISSORAS SUL BRASILEIRAS LTDA</td>
      <td>50433937009</td>
      <td>Horizontina</td>
      <td>RS</td>
      <td>5f8dcc96f23f9</td>
      <td></td>
      <td>95818506000119</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># es_profile</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">RIGHT</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;@id&#39;</span><span class="p">,</span> <span class="s1">&#39;@fistel&#39;</span><span class="p">,</span> <span class="s1">&#39;@SiglaServico&#39;</span><span class="p">,</span> <span class="s1">&#39;@state&#39;</span><span class="p">]</span>
<span class="n">LEFT</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;@id&#39;</span><span class="p">,</span> <span class="s1">&#39;@Fistel&#39;</span><span class="p">,</span> <span class="s1">&#39;@Servico&#39;</span><span class="p">,</span> <span class="s1">&#39;@Status&#39;</span><span class="p">]</span>
<span class="n">ON</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Id&#39;</span><span class="p">,</span> <span class="s1">&#39;Fistel&#39;</span><span class="p">,</span> <span class="s1">&#39;Serviço&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span> <span class="c1">#.drop(RIGHT, axis=1)</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(49340, 22)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">COLS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Serviço&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Entidade&#39;</span><span class="p">,</span> <span class="s1">&#39;Fistel&#39;</span><span class="p">,</span> <span class="s1">&#39;Município&#39;</span><span class="p">,</span> <span class="s1">&#39;UF&#39;</span><span class="p">,</span> <span class="s1">&#39;CNPJ&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">COLS</span><span class="p">:</span>
    <span class="n">col_x</span> <span class="o">=</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_x&#39;</span>
    <span class="n">col_y</span> <span class="o">=</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_y&#39;</span>
    <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">col_x</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">df</span><span class="p">[</span><span class="n">col_y</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">():</span>
        <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">col_x</span><span class="p">,</span> <span class="n">col_y</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">col_y</span><span class="p">,</span> <span class="n">col_x</span>
        
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">b</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Frequência</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;D:\OneDrive - ANATEL\GR01FI3\BaseDados\municípios.xlsx&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Coordenadas_do_Município&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Latitude</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Longitude</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Frequência&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Frequência</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Latitude</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">m</span><span class="o">.</span><span class="n">Município</span> <span class="o">==</span> <span class="n">row</span><span class="o">.</span><span class="n">Município</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">UF</span> <span class="o">==</span> <span class="n">row</span><span class="o">.</span><span class="n">UF</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>    
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;Coordenadas_do_Município&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Latitude</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Longitude</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Frequência&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Frequência</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">País</span> <span class="o">==</span> <span class="s1">&#39;BRA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># from geopy import *</span>
<span class="c1"># geolocator = Nominatim(user_agent=&#39;anateldb&#39;)</span>

<span class="c1"># for row in tqdm(df[df.Município.isna()].itertuples()):</span>
<span class="c1">#     loc = geolocator.reverse((row.Latitude,row.Longitude))</span>
<span class="c1">#     df.loc[row.Index, &#39;UF&#39;] = SIGLAS[loc.raw.get(&#39;address&#39;).get(&#39;state&#39;)]</span>
<span class="c1">#     df.loc[row.Index, &#39;Município&#39;] = loc.raw.get(&#39;address&#39;).get(&#39;town&#39;)</span>
    
<span class="c1">#     elif not loc:</span>
<span class="c1">#         df.loc[row.Index, &#39;UF&#39;] = row.País</span>
<span class="c1">#         df.loc[row.Index, &#39;Município&#39;] = row.País            </span>
<span class="c1">#     else:</span>
<span class="c1">#         if (address := loc.raw.get(&#39;address&#39;)):</span>
<span class="c1">#             if uf := address.get(&#39;state&#39;):</span>
<span class="c1">#                 df.loc[row.Index, &#39;UF&#39;] = uf</span>
<span class="c1">#             else:</span>
<span class="c1">#                 df.loc[row.Index, &#39;UF&#39;] = row.País</span>
<span class="c1">#             if cidade := address.get(&#39;city&#39;):</span>
<span class="c1">#                 df.loc[row.Index, &#39;Município&#39;] = cidade</span>
<span class="c1">#             else:</span>
<span class="c1">#                 df.loc[row.Index, &#39;Município&#39;] = row.País            </span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># merge_profile</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="s1">&#39;D:\OneDrive - ANATEL\GR01FI3\BaseDados\mosaico.fth&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s1">&#39;D:\OneDrive - ANATEL\GR01FI3\BaseDados\mosaico.fth&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Serviço</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;OM&#39;, &#39;TV&#39;, &#39;TVA&#39;, &#39;RTV&#39;, &#39;RTVD&#39;, &#39;GTVD&#39;, &#39;PBTVD&#39;, &#39;FM&#39;],
      dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># profile</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">radcom</span> <span class="o">=</span> <span class="n">read_radcom</span><span class="p">(</span><span class="s1">&#39;D:\OneDrive - ANATEL\GR01FI3\BaseDados&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">radcom</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequência</th>
      <th>Fase</th>
      <th>Situação</th>
      <th>Unidade</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Número da Estação</th>
      <th>Município</th>
      <th>UF</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>CNPJ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>104.9</td>
      <td>3</td>
      <td>A</td>
      <td>MHz</td>
      <td>ACADEMIA CULTURAL DE SANTA HELENA - ACULT - ST...</td>
      <td>50011685115</td>
      <td>641168764</td>
      <td>Santa Helena</td>
      <td>PR</td>
      <td>-24.861389</td>
      <td>-54.334722</td>
      <td>00104477000117</td>
    </tr>
    <tr>
      <th>1</th>
      <td>87.9</td>
      <td>3</td>
      <td>M</td>
      <td>MHz</td>
      <td>ASSOCIACAO DOS MORADORES E PRODUT. RURAIS DE A...</td>
      <td>50012524409</td>
      <td>682699349</td>
      <td>Assunção</td>
      <td>PB</td>
      <td>-7.074444</td>
      <td>-36.731111</td>
      <td>00284576000128</td>
    </tr>
    <tr>
      <th>2</th>
      <td>87.9</td>
      <td>3</td>
      <td>H</td>
      <td>MHz</td>
      <td>ASSOCIACAO BONFIM ESPERANCA- ABESPE</td>
      <td>50011824689</td>
      <td>659028590</td>
      <td>Bonfim</td>
      <td>MG</td>
      <td>-20.323611</td>
      <td>-44.246944</td>
      <td>00575697000129</td>
    </tr>
    <tr>
      <th>3</th>
      <td>104.9</td>
      <td>3</td>
      <td>B</td>
      <td>MHz</td>
      <td>ASSOCIACAO DOS TRABALHADORES DE GUIMARANIA (ATG)</td>
      <td>50011398132</td>
      <td>631410937</td>
      <td>Guimarânia</td>
      <td>MG</td>
      <td>-18.843611</td>
      <td>-46.792778</td>
      <td>00792795000118</td>
    </tr>
    <tr>
      <th>4</th>
      <td>87.9</td>
      <td>3</td>
      <td>M</td>
      <td>MHz</td>
      <td>FUNDACAO ASSISTENCIAL LAR DA PAZ - FALP</td>
      <td>50011398990</td>
      <td>631412301</td>
      <td>Dores do Indaiá</td>
      <td>MG</td>
      <td>-19.466667</td>
      <td>-45.600000</td>
      <td>00794510000188</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">radcom</span><span class="p">[</span><span class="s1">&#39;Serviço&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;231&#39;</span>
<span class="n">radcom</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;RADCOM&#39;</span>
<span class="n">radcom</span><span class="p">[</span><span class="s1">&#39;Classe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radcom</span><span class="o">.</span><span class="n">Fase</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">radcom</span><span class="o">.</span><span class="n">Situação</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">radcom</span><span class="p">[</span><span class="s1">&#39;Entidade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radcom</span><span class="o">.</span><span class="n">Entidade</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radcom</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Frequência&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="p">;</span> <span class="n">rd</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Serviço</th>
      <th>Status</th>
      <th>Entidade</th>
      <th>Município</th>
      <th>UF</th>
      <th>Id</th>
      <th>Frequência</th>
      <th>Classe</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Canal</th>
      <th>País</th>
      <th>Fistel</th>
      <th>Número da Estação</th>
      <th>CNPJ</th>
      <th>Coordenadas_do_Município</th>
      <th>Fase</th>
      <th>Situação</th>
      <th>Unidade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44531</th>
      <td>OM</td>
      <td>AM-C7</td>
      <td>RADIODIFUSAO RAINHA DO CEU LTDA</td>
      <td>Bezerros</td>
      <td>PE</td>
      <td>57dbac68e0938</td>
      <td>1590.0</td>
      <td>C</td>
      <td>-8.309444</td>
      <td>-35.847500</td>
      <td>NaN</td>
      <td>BRA</td>
      <td>50401708586</td>
      <td>692535004</td>
      <td>01889115000141</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>44532</th>
      <td>OM</td>
      <td>AM-C7</td>
      <td>ALTERNATIVA FM LTDA</td>
      <td>Lambari</td>
      <td>MG</td>
      <td>57dbac635271a</td>
      <td>1590.0</td>
      <td>C</td>
      <td>-21.966667</td>
      <td>-45.366667</td>
      <td>NaN</td>
      <td>BRA</td>
      <td>50012009385</td>
      <td>323663990</td>
      <td>02406140000190</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>44533</th>
      <td>OM</td>
      <td>AM-C4</td>
      <td>RADIO FLORESTA VERDE AM DE JOINVILLE LTDA</td>
      <td>Joinville</td>
      <td>SC</td>
      <td>57dbac745cc94</td>
      <td>1590.0</td>
      <td>B</td>
      <td>-26.275806</td>
      <td>-48.780389</td>
      <td>NaN</td>
      <td>BRA</td>
      <td>14030026656</td>
      <td>323092799</td>
      <td>79419263000190</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>44534</th>
      <td>OM</td>
      <td>AM-C0</td>
      <td>NaN</td>
      <td>Sertão</td>
      <td>RS</td>
      <td>57dbac72e2c41</td>
      <td>1600.0</td>
      <td>C</td>
      <td>-27.983333</td>
      <td>-52.250000</td>
      <td>NaN</td>
      <td>BRA</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>44535</th>
      <td>OM</td>
      <td>AM-C4</td>
      <td>FUNDACAO METROPOLITANA PAULISTA</td>
      <td>São Paulo</td>
      <td>SP</td>
      <td>57dbac7a245c7</td>
      <td>1600.0</td>
      <td>B</td>
      <td>-23.501389</td>
      <td>-46.691944</td>
      <td>NaN</td>
      <td>BRA</td>
      <td>02032083310</td>
      <td>9252657</td>
      <td>50951847000120</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rd</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;AM&#39;</span><span class="p">),</span> <span class="s1">&#39;Frequência&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rd</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;AM&#39;</span><span class="p">),</span> <span class="s1">&#39;Frequência&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span> <span class="p">;</span> <span class="n">rd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rd</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;AM&#39;</span><span class="p">),</span> <span class="s1">&#39;Frequência&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>29283    0.54
29284    0.54
29285    0.54
29286    0.54
29287    0.54
Name: Frequência, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">rd</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Serviço</th>
      <th>Status</th>
      <th>Entidade</th>
      <th>Município</th>
      <th>UF</th>
      <th>Id</th>
      <th>Frequência</th>
      <th>Classe</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Canal</th>
      <th>País</th>
      <th>Fistel</th>
      <th>Número da Estação</th>
      <th>CNPJ</th>
      <th>Coordenadas_do_Município</th>
      <th>Fase</th>
      <th>Situação</th>
      <th>Unidade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44531</th>
      <td>OM</td>
      <td>AM-C7</td>
      <td>RADIODIFUSAO RAINHA DO CEU LTDA</td>
      <td>Bezerros</td>
      <td>PE</td>
      <td>57dbac68e0938</td>
      <td>1.59</td>
      <td>C</td>
      <td>-8.309444</td>
      <td>-35.847500</td>
      <td>-</td>
      <td>BRA</td>
      <td>50401708586</td>
      <td>692535004</td>
      <td>01889115000141</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>44532</th>
      <td>OM</td>
      <td>AM-C7</td>
      <td>ALTERNATIVA FM LTDA</td>
      <td>Lambari</td>
      <td>MG</td>
      <td>57dbac635271a</td>
      <td>1.59</td>
      <td>C</td>
      <td>-21.966667</td>
      <td>-45.366667</td>
      <td>-</td>
      <td>BRA</td>
      <td>50012009385</td>
      <td>323663990</td>
      <td>02406140000190</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>44533</th>
      <td>OM</td>
      <td>AM-C4</td>
      <td>RADIO FLORESTA VERDE AM DE JOINVILLE LTDA</td>
      <td>Joinville</td>
      <td>SC</td>
      <td>57dbac745cc94</td>
      <td>1.59</td>
      <td>B</td>
      <td>-26.275806</td>
      <td>-48.780389</td>
      <td>-</td>
      <td>BRA</td>
      <td>14030026656</td>
      <td>323092799</td>
      <td>79419263000190</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>44534</th>
      <td>OM</td>
      <td>AM-C0</td>
      <td>-</td>
      <td>Sertão</td>
      <td>RS</td>
      <td>57dbac72e2c41</td>
      <td>1.60</td>
      <td>C</td>
      <td>-27.983333</td>
      <td>-52.250000</td>
      <td>-</td>
      <td>BRA</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>44535</th>
      <td>OM</td>
      <td>AM-C4</td>
      <td>FUNDACAO METROPOLITANA PAULISTA</td>
      <td>São Paulo</td>
      <td>SP</td>
      <td>57dbac7a245c7</td>
      <td>1.60</td>
      <td>B</td>
      <td>-23.501389</td>
      <td>-46.691944</td>
      <td>-</td>
      <td>BRA</td>
      <td>02032083310</td>
      <td>9252657</td>
      <td>50951847000120</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(44536, 19)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">rd</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">,</span> <span class="s1">&#39;RADCOM&#39;</span><span class="p">]:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rd</span><span class="p">[</span><span class="n">rd</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">s</span><span class="p">)])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(28028, 19)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span> <span class="o">=</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">Status</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">rd</span><span class="o">.</span><span class="n">Classe</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">rd</span><span class="o">.</span><span class="n">Entidade</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> \
                                <span class="n">rd</span><span class="o">.</span><span class="n">Fistel</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">rd</span><span class="p">[</span><span class="s1">&#39;Número da Estação&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;), &#39;</span> <span class="o">+</span> <span class="n">rd</span><span class="o">.</span><span class="n">Município</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> \
                                <span class="n">rd</span><span class="o">.</span><span class="n">UF</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rd</span><span class="o">.</span><span class="n">Coordenadas_do_Município</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rd</span><span class="o">.</span><span class="n">Coordenadas_do_Município</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Serviço</th>
      <th>Status</th>
      <th>Entidade</th>
      <th>Município</th>
      <th>UF</th>
      <th>Id</th>
      <th>Frequência</th>
      <th>Classe</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Canal</th>
      <th>País</th>
      <th>Fistel</th>
      <th>Número da Estação</th>
      <th>CNPJ</th>
      <th>Coordenadas_do_Município</th>
      <th>Fase</th>
      <th>Situação</th>
      <th>Unidade</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RTV</td>
      <td>TV-C1</td>
      <td>PREFEITURA MUNICIPAL DE JACARACI</td>
      <td>Jacaraci</td>
      <td>BA</td>
      <td>57dbaae93fd68</td>
      <td>57.0</td>
      <td>C</td>
      <td>-14.849720</td>
      <td>-42.433330</td>
      <td>2</td>
      <td>BRA</td>
      <td>50400457865</td>
      <td>322641683</td>
      <td>13677109000100</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>TV-C1, C, Prefeitura Municipal De Jacaraci (50...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RTV</td>
      <td>TV-C1</td>
      <td>PREFEITURA MUNICIPAL DE MONTE CARLO</td>
      <td>Monte Carlo</td>
      <td>SC</td>
      <td>57dbab5752aa7</td>
      <td>57.0</td>
      <td>C</td>
      <td>-27.222780</td>
      <td>-50.979720</td>
      <td>2</td>
      <td>BRA</td>
      <td>14030175570</td>
      <td>323099955</td>
      <td>95996104000104</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>TV-C1, C, Prefeitura Municipal De Monte Carlo ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RTV</td>
      <td>TV-C1</td>
      <td>PREFEITURA MUNICIPAL DE PAPANDUVA</td>
      <td>Papanduva</td>
      <td>SC</td>
      <td>57dbab57beb7c</td>
      <td>57.0</td>
      <td>C</td>
      <td>-26.370280</td>
      <td>-50.144440</td>
      <td>2</td>
      <td>BRA</td>
      <td>14023497690</td>
      <td>323089178</td>
      <td>83102533000101</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>TV-C1, C, Prefeitura Municipal De Papanduva (1...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RTV</td>
      <td>TV-C1</td>
      <td>TV GAZETA DE ALAGOAS LTDA</td>
      <td>Água Branca</td>
      <td>AL</td>
      <td>57dbaadc3eb7c</td>
      <td>57.0</td>
      <td>A</td>
      <td>-9.266667</td>
      <td>-37.933333</td>
      <td>2</td>
      <td>BRA</td>
      <td>50400517868</td>
      <td>323710034</td>
      <td>12186524000106</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>TV-C1, A, Tv Gazeta De Alagoas Ltda (504005178...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RTV</td>
      <td>TV-C1</td>
      <td>PREFEITURA MUNICIPAL DE OEIRAS</td>
      <td>Oeiras</td>
      <td>PI</td>
      <td>57dbab2f63994</td>
      <td>57.0</td>
      <td>B</td>
      <td>-7.016667</td>
      <td>-42.133333</td>
      <td>2</td>
      <td>BRA</td>
      <td>19000170168</td>
      <td>323231314</td>
      <td>06553937000170</td>
      <td>False</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>TV-C1, B, Prefeitura Municipal De Oeiras (1900...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="n">rd</span><span class="p">[[</span><span class="s1">&#39;Frequência&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">exp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stel</span> <span class="o">=</span> <span class="n">read_stel</span><span class="p">(</span><span class="s1">&#39;D:\OneDrive - ANATEL\GR01FI3\BaseDados&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Frequência&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">TELECOM</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stel</span><span class="o">.</span><span class="n">Serviço</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;019&#39;, &#39;035&#39;, &#39;078&#39;, &#39;079&#39;, &#39;033&#39;, &#39;108&#39;, &#39;132&#39;, &#39;507&#39;, &#39;017&#39;,
       &#39;011&#39;, &#39;124&#39;, &#39;125&#39;, &#39;604&#39;, &#39;064&#39;, &#39;046&#39;, &#39;053&#39;, &#39;099&#39;, &#39;012&#39;],
      dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slma</span> <span class="o">=</span> <span class="p">(</span><span class="n">stel</span><span class="o">.</span><span class="n">Frequência</span> <span class="o">&gt;=</span> <span class="mi">108</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">stel</span><span class="o">.</span><span class="n">Frequência</span> <span class="o">&lt;=</span> <span class="mi">137</span><span class="p">)</span>
<span class="n">telecom</span> <span class="o">=</span> <span class="n">stel</span><span class="p">[</span><span class="o">~</span><span class="n">slma</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">slma</span> <span class="o">=</span> <span class="n">stel</span><span class="p">[</span><span class="n">slma</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slma</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slma</span><span class="o">.</span><span class="n">Serviço</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">slma</span><span class="o">.</span><span class="n">Entidade</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">slma</span><span class="o">.</span><span class="n">Fistel</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>  <span class="n">slma</span><span class="p">[</span><span class="s1">&#39;Número da Estação&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;), &#39;</span> <span class="o">+</span> \
                        <span class="n">slma</span><span class="p">[</span><span class="s1">&#39;Município&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">slma</span><span class="o">.</span><span class="n">UF</span>
<span class="n">telecom</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">telecom</span><span class="o">.</span><span class="n">Serviço</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">telecom</span><span class="o">.</span><span class="n">Entidade</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">telecom</span><span class="o">.</span><span class="n">Fistel</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">telecom</span><span class="p">[</span><span class="s1">&#39;Número da Estação&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;), &#39;</span> <span class="o">+</span> \
                           <span class="n">telecom</span><span class="p">[</span><span class="s1">&#39;Município&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">telecom</span><span class="o">.</span><span class="n">UF</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slma</span> <span class="o">=</span> <span class="n">slma</span><span class="p">[[</span><span class="s1">&#39;Frequência&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]]</span>
<span class="n">slma</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">telecom</span> <span class="o">=</span> <span class="n">telecom</span><span class="p">[[</span><span class="s1">&#39;Frequência&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]]</span>
<span class="n">telecom</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39; Da &#39;</span><span class="p">:</span> <span class="s1">&#39; da &#39;</span><span class="p">,</span> <span class="s1">&#39; De &#39;</span><span class="p">:</span> <span class="s1">&#39; de &#39;</span><span class="p">,</span> <span class="s1">&#39; Do &#39;</span><span class="p">:</span> <span class="s1">&#39; do &#39;</span><span class="p">,</span>
       <span class="s1">&#39; Das &#39;</span><span class="p">:</span> <span class="s1">&#39; das &#39;</span><span class="p">,</span> <span class="s1">&#39; Dos &#39;</span><span class="p">:</span> <span class="s1">&#39; dos &#39;</span><span class="p">,</span> <span class="s1">&#39; E &#39;</span><span class="p">:</span> <span class="s1">&#39; e &#39;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">sub</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">exp</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
    <span class="n">slma</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slma</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
    <span class="n">telecom</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">telecom</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exp</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\s{2,}&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">slma</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slma</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\s{2,}&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">telecom</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">telecom</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\s{2,}&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dest</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;D:\OneDrive - ANATEL\GR01FI3\BaseDados\FiltroAppAnalise&#39;</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
    <span class="n">p</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_T%H%M%S&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dest</span><span class="si">}</span><span class="s1">/AnatelDB_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">.xlsx&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">workbook</span><span class="p">:</span>
    <span class="n">exp</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">slma</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet2&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">telecom</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet3&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Status&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s1">&#39;Serviço&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Status
TV-C0        5789
TV-C3        4942
TV-C7        4738
RADCOM       4644
TV-C4        4081
FM-C0        3458
TV-C2        3251
FM-RES       2320
FM-C4        1534
TV-RES       1474
TV-C1        1206
AM-C0         875
FM-C3         875
FM-C7         609
AM-C7         604
FM-C2         535
TV-C5         427
FM-C1         400
TV-CV-04      336
FM-AT-03      281
AM-C3         265
AM-RES        232
FM-C5         208
AM-C4         165
TV-CP-03      153
TV-AT-03      132
FM-CI-01      125
TV-CP-01      109
AM-C2          98
AM-C1          81
FM-CP-03       77
AM-CE-01       76
FM-AT-01       52
TV-AT-01       52
TV-ATO-02      51
FM-CP-01       49
TV-CI-01       40
TV-EX-01       39
FM-ATO-02      34
FM-AT-02       25
FM-ATO-03      24
TV-C98         21
TV-AT-02       12
FM-EX-01       10
AM-CI-01        6
FM-CO-01        5
AM-CO-01        4
FM-C99          2
AM-CP-01        2
TV-CO-01        2
AM-C99          2
FM-EX-02        2
AM-C5           1
AM-AT-03        1
Name: Serviço, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># geolocator = Nominatim(user_agent=&#39;anateldb&#39;)</span>

<span class="c1"># from geopy.extra.rate_limiter import RateLimiter</span>
<span class="c1"># geocode = RateLimiter(geolocator.reverse, min_delay_seconds=1)</span>

<span class="c1"># def info_from_coord(row):</span>
<span class="c1">#     loc = geocode((row.Latitude,row.Longitude))</span>
<span class="c1">#     if not hasattr(loc, &#39;raw&#39;):</span>
<span class="c1">#         return row.País, row.País</span>
<span class="c1">#     if (address := loc.raw.get(&#39;address&#39;)):</span>
<span class="c1">#         if not (uf := address.get(&#39;state&#39;)): </span>
<span class="c1">#             uf = row.País             </span>
<span class="c1">#         if not (cidade := address.get(&#39;city&#39;)):</span>
<span class="c1">#             if not (cidade := address.get(&#39;town&#39;)):</span>
<span class="c1">#                 cidade = row.País</span>
<span class="c1">#         return cidade, uf</span>
<span class="c1">#     return row.País, row.País</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

