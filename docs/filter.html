---

title: Filtragem


keywords: fastai
sidebar: home_sidebar

summary: "Este módulo concentra funções auxiliares específicas que filtram os dados do banco com campos e formatação de interesse para aplicações específicas como o <a href='https://github.com/EricMagalhaesDelgado/appAnalise'>appAnalise</a> por exemplo."
description: "Este módulo concentra funções auxiliares específicas que filtram os dados do banco com campos e formatação de interesse para aplicações específicas como o <a href='https://github.com/EricMagalhaesDelgado/appAnalise'>appAnalise</a> por exemplo."
nb_path: "nbs\filter.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\filter.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bump_version" class="doc_header"><code>bump_version</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/filter.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bump_version</code>(<strong><code>version</code></strong>, <strong><code>part</code></strong>=<em><code>2</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="formatar_db" class="doc_header"><code>formatar_db</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/filter.py#L109" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>formatar_db</code>(<strong><code>path</code></strong>:"Pasta onde salvar os arquivos", <strong><code>up_stel</code></strong>:"Atualizar a base do Stel"=<em><code>False</code></em>, <strong><code>up_radcom</code></strong>:"Atualizar a base do Radcom"=<em><code>False</code></em>, <strong><code>up_mosaico</code></strong>:"Atualizar a base do Mosaico"=<em><code>False</code></em>, <strong><code>up_icao</code></strong>:"Atualizar a base do ICAO"=<em><code>False</code></em>, <strong><code>up_pmec</code></strong>:"Atualizar a base do PMEC"=<em><code>False</code></em>, <strong><code>up_geo</code></strong>:"Atualizar a base do Geo"=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pasta</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;c:/Users/rsilva/AnatelDatabase&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">pasta</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">subprocess</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;clone&#39;</span><span class="p">,</span> <span class="s1">&#39;https://github.com/ronaldokun/AnatelDatabase.git&#39;</span><span class="p">])</span>
    <span class="n">pasta</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s1">&#39;AnatelDatabase&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">icao</span> <span class="o">=</span> <span class="n">read_icao</span><span class="p">(</span><span class="n">pasta</span><span class="p">)</span>
<span class="n">pmec</span> <span class="o">=</span> <span class="n">read_pmec</span><span class="p">(</span><span class="n">pasta</span><span class="p">)</span>
<span class="n">geo</span> <span class="o">=</span> <span class="n">read_geo</span><span class="p">(</span><span class="n">pasta</span><span class="p">)</span>
<span class="n">icao</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">icao</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>
<span class="n">pmec</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pmec</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>
<span class="n">geo</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">icao</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">pmec</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">geo</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2632</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">971</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">285</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span><span style="font-weight: bold">)</span>
</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Station&#39;</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">icao</span><span class="p">[</span><span class="n">icao</span><span class="o">.</span><span class="n">Station</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pmec</span><span class="p">[</span><span class="n">pmec</span><span class="o">.</span><span class="n">Station</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">geo</span><span class="p">[</span><span class="n">geo</span><span class="o">.</span><span class="n">Station</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">merge_df</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">merge_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Station</th>
      <th>Description</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Service</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>109.100</td>
      <td>696597080</td>
      <td>[ICAO] ILS/DME, JUIZ DE FORA</td>
      <td>-21.783333</td>
      <td>-43.383335</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>109.300</td>
      <td>1008242052</td>
      <td>[ICAO] ILS, RIO DE JANEIRO INTL.</td>
      <td>-22.799999</td>
      <td>-43.216667</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>110.300</td>
      <td>1000822769</td>
      <td>[ICAO] ILS, CAMPINAS VIRACOPOS, SP | [AISW] SB...</td>
      <td>-23.017500</td>
      <td>-47.117500</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>110.700</td>
      <td>1000823269</td>
      <td>[ICAO] ILS, SAO PAULO GUARULHOS INTL. | [AISW]...</td>
      <td>-23.425468</td>
      <td>-46.464542</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>111.100</td>
      <td>1000823242</td>
      <td>[ICAO] ILS, SAO PAULO GUARULHOS INTL. | [AISW]...</td>
      <td>-23.436501</td>
      <td>-46.486748</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1606</th>
      <td>1193.000</td>
      <td>1000822904</td>
      <td>[DOC] SBME-RDONAV, VOR/DME MCA, MACAE (Ground-...</td>
      <td>-22.344475</td>
      <td>-41.769001</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>1607</th>
      <td>1195.000</td>
      <td>1000823692</td>
      <td>[DOC] SBUL-RDONAV, VOR/DME ULD, TEN CEL AV CÉS...</td>
      <td>-18.876638</td>
      <td>-48.221313</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>1608</th>
      <td>1198.000</td>
      <td>1000823781</td>
      <td>[DOC] SBVT-RDONAV, VOR/DME VRI, Eurico de Agui...</td>
      <td>-20.260166</td>
      <td>-40.285000</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>1609</th>
      <td>0.355</td>
      <td>690266120</td>
      <td>[AISG] NDB - URUCU OPR PETROBRAS</td>
      <td>-4.886500</td>
      <td>-65.349831</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>1610</th>
      <td>991.000</td>
      <td>1000823218</td>
      <td>[AISG] DME -  30X</td>
      <td>-2.422000</td>
      <td>-54.789165</td>
      <td>108.0</td>
    </tr>
  </tbody>
</table>
<p>1484 rows × 6 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">merge_diff</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Merge two dataframes&quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Description_x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Description_y</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Description_x&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Description_y&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Latitude_x&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Longitude_x&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Latitude_y&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Longitude_y&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Service&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Service_x&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Service&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;Service_y&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;_&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">icao</span><span class="p">[</span><span class="n">icao</span><span class="o">.</span><span class="n">Station</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Service&#39;</span><span class="p">,</span> <span class="s1">&#39;Station&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pmec</span><span class="p">[</span><span class="n">pmec</span><span class="o">.</span><span class="n">Station</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Service&#39;</span><span class="p">,</span> <span class="s1">&#39;Station&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">geo</span><span class="p">[</span><span class="n">geo</span><span class="o">.</span><span class="n">Station</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Service&#39;</span><span class="p">,</span> <span class="s1">&#39;Station&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1148</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">600</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">213</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span><span style="font-weight: bold">)</span>
</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">abc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">abc</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Latitude_x</th>
      <th>Longitude_x</th>
      <th>Description_x</th>
      <th>Latitude_y</th>
      <th>Longitude_y</th>
      <th>Description_y</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>109.1</td>
      <td>-25.600000</td>
      <td>-54.466667</td>
      <td>[ICAO] ILS, FOZ DO IGUACU CATARATAS</td>
      <td>-25.602833</td>
      <td>-54.478500</td>
      <td>[AISW] SBFI-RDONAV, ILS/DME 14 IFI, Cataratas</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>109.3</td>
      <td>-1.366667</td>
      <td>-48.466667</td>
      <td>[ICAO] ILS/DME, BELEM VAL DE CAES</td>
      <td>-2.578333</td>
      <td>-44.228333</td>
      <td>[AISW] SBSL-RDONAV, ILS/DME 06 ISL, Marechal C...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>109.3</td>
      <td>-1.366667</td>
      <td>-48.466667</td>
      <td>[ICAO] ILS/DME, BELEM VAL DE CAES</td>
      <td>-23.637667</td>
      <td>-46.648834</td>
      <td>[AISW] SBSP-RDONAV, ILS/DME 17R ISP, Congonhas</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>109.3</td>
      <td>-1.366667</td>
      <td>-48.466667</td>
      <td>[ICAO] ILS/DME, BELEM VAL DE CAES</td>
      <td>-20.267000</td>
      <td>-40.292835</td>
      <td>[AISW] SBVT-RDONAV, ILS/DME 24 IVI, Eurico de ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>109.3</td>
      <td>-1.366667</td>
      <td>-48.466667</td>
      <td>[ICAO] ILS/DME, BELEM VAL DE CAES</td>
      <td>-9.861167</td>
      <td>-67.881668</td>
      <td>[AISW] SBRB-RDONAV, ILS/DME 06 IRB, Plácido de...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4270</th>
      <td>116.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>-27.135693</td>
      <td>-52.662968</td>
      <td>[AISG] VOR - CHAPECÓ OPR CITY HALL CH 108X</td>
    </tr>
    <tr>
      <th>4271</th>
      <td>967.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>-2.578333</td>
      <td>-44.228333</td>
      <td>[AISG] DME - SÃO LUIZ 6X</td>
    </tr>
    <tr>
      <th>4272</th>
      <td>985.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>-21.700470</td>
      <td>-41.307671</td>
      <td>[AISG] DME - CAMPOS 24X</td>
    </tr>
    <tr>
      <th>4273</th>
      <td>1182.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>-22.967175</td>
      <td>-42.890945</td>
      <td>[AISG] DME - MARICÁ 95X</td>
    </tr>
    <tr>
      <th>4274</th>
      <td>1195.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>-27.135693</td>
      <td>-52.662968</td>
      <td>[AISG] DME - CHAPECÓ 108X</td>
    </tr>
  </tbody>
</table>
<p>4275 rows × 10 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">Description_x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">Description_y</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">c</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;_x&#39;</span><span class="p">,</span> <span class="s1">&#39;_y&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Latitude</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Longitude</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Description</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]]</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new</span><span class="p">,</span> <span class="n">temp</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">new</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">new</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>112.2</td>
      <td>-22.35</td>
      <td>-49.049999</td>
      <td>[ICAO] VOR/DME, BAURU</td>
    </tr>
    <tr>
      <th>1</th>
      <td>112.2</td>
      <td>-14.8</td>
      <td>-39.016666</td>
      <td>[ICAO] VOR/DME, ILHEUS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>112.3</td>
      <td>-12.9</td>
      <td>-38.400002</td>
      <td>[ICAO] VOR, ITAPARICA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>112.3</td>
      <td>-5.066667</td>
      <td>-42.816666</td>
      <td>[ICAO] VOR/DME, TERESINA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>112.5</td>
      <td>-5.8</td>
      <td>-61.283333</td>
      <td>[ICAO] VOR, MANICORE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>976</th>
      <td>116.1</td>
      <td>-27.135693</td>
      <td>-52.662968</td>
      <td>[AISG] VOR - CHAPECÓ OPR CITY HALL CH 108X</td>
    </tr>
    <tr>
      <th>977</th>
      <td>967.0</td>
      <td>-2.578333</td>
      <td>-44.228333</td>
      <td>[AISG] DME - SÃO LUIZ 6X</td>
    </tr>
    <tr>
      <th>978</th>
      <td>985.0</td>
      <td>-21.70047</td>
      <td>-41.307671</td>
      <td>[AISG] DME - CAMPOS 24X</td>
    </tr>
    <tr>
      <th>979</th>
      <td>1182.0</td>
      <td>-22.967175</td>
      <td>-42.890945</td>
      <td>[AISG] DME - MARICÁ 95X</td>
    </tr>
    <tr>
      <th>980</th>
      <td>1195.0</td>
      <td>-27.135693</td>
      <td>-52.662968</td>
      <td>[AISG] DME - CHAPECÓ 108X</td>
    </tr>
  </tbody>
</table>
<p>981 rows × 4 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">y</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">)],</span> <span class="p">[(</span><span class="s1">&#39;_x&#39;</span><span class="p">,</span><span class="s1">&#39;_y&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;_x&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;_y&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)]):</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">abc</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">geodesic</span><span class="p">((</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Latitude</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Longitude</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Latitude</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Longitude</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">m</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Frequency</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Latitude</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Latitude</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Longitude</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Longitude</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Description</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; | &#39;</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Description</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">f</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">d</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Latitude</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Longitude</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Description</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
            <span class="n">l</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">columns</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Latitude</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Longitude</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Description</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
            <span class="n">r</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">columns</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">new</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">new</span>            
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>112.2</td>
      <td>-22.35</td>
      <td>-49.049999</td>
      <td>[ICAO] VOR/DME, BAURU</td>
    </tr>
    <tr>
      <th>1</th>
      <td>112.2</td>
      <td>-14.8</td>
      <td>-39.016666</td>
      <td>[ICAO] VOR/DME, ILHEUS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>112.3</td>
      <td>-12.9</td>
      <td>-38.400002</td>
      <td>[ICAO] VOR, ITAPARICA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>112.3</td>
      <td>-5.066667</td>
      <td>-42.816666</td>
      <td>[ICAO] VOR/DME, TERESINA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>112.5</td>
      <td>-5.8</td>
      <td>-61.283333</td>
      <td>[ICAO] VOR, MANICORE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2723</th>
      <td>1192.0</td>
      <td>-21.984501</td>
      <td>-47.344501</td>
      <td>[DOC] SBYS-RDONAV, VOR/DME PIR, CAMPO FONTENEL...</td>
    </tr>
    <tr>
      <th>2724</th>
      <td>1192.0</td>
      <td>-3.04003</td>
      <td>-60.054737</td>
      <td>[AISG] DME - MANAUS 105X</td>
    </tr>
    <tr>
      <th>2725</th>
      <td>1198.0</td>
      <td>-9.87599</td>
      <td>-67.905357</td>
      <td>[DOC] SBRB-RDONAV, VOR/DME RCO, Plácido de Cas...</td>
    </tr>
    <tr>
      <th>2726</th>
      <td>1200.0</td>
      <td>-0.150306</td>
      <td>-66.990536</td>
      <td>[DOC] SBUA-RDONAV, VOR/DME GBR, São Gabriel da...</td>
    </tr>
    <tr>
      <th>2727</th>
      <td>1202.0</td>
      <td>-16.24535</td>
      <td>-48.979128</td>
      <td>[DOC] SBAN-RDONAV, VOR/DME APO, Campo Marechal...</td>
    </tr>
  </tbody>
</table>
<p>1496 rows × 4 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">abc</span><span class="p">[</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">geodesic</span><span class="p">((</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Latitude_x&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Longitude_x&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Latitude_y&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Longitude_y&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">m</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">geodesic</span><span class="p">((</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Latitude_x&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Longitude_x&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">m</span>
    <span class="n">d3</span> <span class="o">=</span> <span class="n">geodesic</span><span class="p">((</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Latitude_y&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Longitude_y&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">m</span>
    <span class="k">if</span> <span class="n">d1</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="ow">and</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="ow">and</span> <span class="n">d3</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Frequency</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Latitude_x</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Latitude_y</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Latitude</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Longitude_x</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Longitude_y</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Longitude</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">d</span> <span class="o">=</span> <span class="s1">&#39; | &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">Description_x</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">Description_y</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">Description</span><span class="p">])</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">f</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">d</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">d1</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="ow">and</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Frequency</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Latitude_x</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Latitude_y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Longitude_x</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Longitude_y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">d</span> <span class="o">=</span> <span class="s1">&#39; | &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">Description_x</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">Description_y</span><span class="p">])</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">f</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">d</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">d1</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="ow">and</span> <span class="n">d3</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Frequency</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Latitude_x</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Latitude</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Longitude_x</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Longitude</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">d</span> <span class="o">=</span> <span class="s1">&#39; | &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">Description_x</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">Description</span><span class="p">])</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">f</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">d</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="ow">and</span> <span class="n">d3</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Frequency</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Latitude_y</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Latitude</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Longitude_y</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">Longitude</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">d</span> <span class="o">=</span> <span class="s1">&#39; | &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">Description_y</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">Description</span><span class="p">])</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">f</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">d</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Description_x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
        <span class="n">l</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude_y&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude_y&#39;</span><span class="p">,</span> <span class="s1">&#39;Description_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
        <span class="n">r</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
        <span class="n">s</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">new</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">new</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>112.2</td>
      <td>-22.35</td>
      <td>-49.049999</td>
      <td>[ICAO] VOR/DME, BAURU</td>
    </tr>
    <tr>
      <th>1</th>
      <td>112.2</td>
      <td>-14.8</td>
      <td>-39.016666</td>
      <td>[ICAO] VOR/DME, ILHEUS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>112.3</td>
      <td>-12.9</td>
      <td>-38.400002</td>
      <td>[ICAO] VOR, ITAPARICA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>112.3</td>
      <td>-5.066667</td>
      <td>-42.816666</td>
      <td>[ICAO] VOR/DME, TERESINA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>112.5</td>
      <td>-5.8</td>
      <td>-61.283333</td>
      <td>[ICAO] VOR, MANICORE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8605</th>
      <td>1211.0</td>
      <td>-19.833334</td>
      <td>-44.0</td>
      <td>[DOC] VOR/DME, BELO HORIZONTE PAMPULHA (Ground...</td>
    </tr>
    <tr>
      <th>8606</th>
      <td>1211.0</td>
      <td>-19.835833</td>
      <td>-44.003502</td>
      <td>[DOC] SBBH-RDONAV, VOR/DME BHZ  a. SECT 100/11...</td>
    </tr>
    <tr>
      <th>8607</th>
      <td>1211.0</td>
      <td>4.693</td>
      <td>-61.028831</td>
      <td>[AISG] DME - LA DIVINA PASTORA 124X</td>
    </tr>
    <tr>
      <th>8610</th>
      <td>1211.0</td>
      <td>-25.778656</td>
      <td>-49.763241</td>
      <td>[AISG] DME - LAPA-PR 124X</td>
    </tr>
    <tr>
      <th>8611</th>
      <td>1211.0</td>
      <td>-19.834979</td>
      <td>-44.002355</td>
      <td>[DOC] VOR/DME, BELO HORIZONTE PAMPULHA (Ground...</td>
    </tr>
  </tbody>
</table>
<p>1878 rows × 4 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">pasta</span> <span class="o">/</span> <span class="s1">&#39;aeronautica.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">hdf5storage</span> <span class="k">as</span> <span class="nn">hdf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">hdf</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pasta</span><span class="si">}</span><span class="s1">/AnatelDB.mat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">hdf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/c/Users/rsilva/db/&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;AnatelDB.mat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">c:\Users\rsilva\anateldb\nbs\filter.ipynb Cell 23&#39;</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; &lt;a href=&#39;vscode-notebook-cell:/c%3A/Users/rsilva/anateldb/nbs/filter.ipynb#ch0000048?line=0&#39;&gt;1&lt;/a&gt;</span> db = hdf.read(path=&#39;/c/Users/rsilva/db/&#39;, filename=&#39;AnatelDB.mat&#39;)

File <span class="ansi-green-intense-fg ansi-bold">~\Miniconda3\envs\db\lib\site-packages\hdf5storage\__init__.py:1566</span>, in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-intense-fg ansi-bold">(path, filename, options, **keywords)</span>
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1514&#39;&gt;1515&lt;/a&gt;</span> def read(path=&#39;/&#39;, filename=&#39;data.h5&#39;,
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1515&#39;&gt;1516&lt;/a&gt;</span>          options=None, **keywords):
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1516&#39;&gt;1517&lt;/a&gt;</span>     &#34;&#34;&#34; Reads one piece of data from an HDF5 file (high level).
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1517&#39;&gt;1518&lt;/a&gt;</span> 
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1518&#39;&gt;1519&lt;/a&gt;</span>     A wrapper around ``reads`` to read a single piece of data at the
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1563&#39;&gt;1564&lt;/a&gt;</span> 
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1564&#39;&gt;1565&lt;/a&gt;</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">-&gt; &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1565&#39;&gt;1566&lt;/a&gt;</span>     return reads(paths=(path,), filename=filename, options=options,
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1566&#39;&gt;1567&lt;/a&gt;</span>                  **keywords)[0]

File <span class="ansi-green-intense-fg ansi-bold">~\Miniconda3\envs\db\lib\site-packages\hdf5storage\__init__.py:1491</span>, in <span class="ansi-cyan-fg">reads</span><span class="ansi-blue-intense-fg ansi-bold">(paths, filename, options, **keywords)</span>
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1488&#39;&gt;1489&lt;/a&gt;</span> try:
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1489&#39;&gt;1490&lt;/a&gt;</span>     f = None
<span class="ansi-green-intense-fg ansi-bold">-&gt; &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1490&#39;&gt;1491&lt;/a&gt;</span>     f = h5py.File(filename, mode=&#39;r&#39;)
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1492&#39;&gt;1493&lt;/a&gt;</span>     # Read the data item by item
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1493&#39;&gt;1494&lt;/a&gt;</span>     datas = []

File <span class="ansi-green-intense-fg ansi-bold">~\Miniconda3\envs\db\lib\site-packages\h5py\_hl\files.py:507</span>, in <span class="ansi-cyan-fg">File.__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, name, mode, driver, libver, userblock_size, swmr, rdcc_nslots, rdcc_nbytes, rdcc_w0, track_order, fs_strategy, fs_persist, fs_threshold, fs_page_size, page_buf_size, min_meta_keep, min_raw_keep, locking, **kwds)</span>
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=501&#39;&gt;502&lt;/a&gt;</span>     fapl = make_fapl(driver, libver, rdcc_nslots, rdcc_nbytes, rdcc_w0,
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=502&#39;&gt;503&lt;/a&gt;</span>                      locking, page_buf_size, min_meta_keep, min_raw_keep, **kwds)
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=503&#39;&gt;504&lt;/a&gt;</span>     fcpl = make_fcpl(track_order=track_order, fs_strategy=fs_strategy,
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=504&#39;&gt;505&lt;/a&gt;</span>                      fs_persist=fs_persist, fs_threshold=fs_threshold,
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=505&#39;&gt;506&lt;/a&gt;</span>                      fs_page_size=fs_page_size)
<span class="ansi-green-intense-fg ansi-bold">--&gt; &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=506&#39;&gt;507&lt;/a&gt;</span>     fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=508&#39;&gt;509&lt;/a&gt;</span> if isinstance(libver, tuple):
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=509&#39;&gt;510&lt;/a&gt;</span>     self._libver = libver

File <span class="ansi-green-intense-fg ansi-bold">~\Miniconda3\envs\db\lib\site-packages\h5py\_hl\files.py:220</span>, in <span class="ansi-cyan-fg">make_fid</span><span class="ansi-blue-intense-fg ansi-bold">(name, mode, userblock_size, fapl, fcpl, swmr)</span>
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=217&#39;&gt;218&lt;/a&gt;</span>     if swmr and swmr_support:
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=218&#39;&gt;219&lt;/a&gt;</span>         flags |= h5f.ACC_SWMR_READ
<span class="ansi-green-intense-fg ansi-bold">--&gt; &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=219&#39;&gt;220&lt;/a&gt;</span>     fid = h5f.open(name, flags, fapl=fapl)
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=220&#39;&gt;221&lt;/a&gt;</span> elif mode == &#39;r+&#39;:
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=221&#39;&gt;222&lt;/a&gt;</span>     fid = h5f.open(name, h5f.ACC_RDWR, fapl=fapl)

File <span class="ansi-green-intense-fg ansi-bold">h5py\_objects.pyx:54</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-intense-fg ansi-bold">()</span>

File <span class="ansi-green-intense-fg ansi-bold">h5py\_objects.pyx:55</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-intense-fg ansi-bold">()</span>

File <span class="ansi-green-intense-fg ansi-bold">h5py\h5f.pyx:106</span>, in <span class="ansi-cyan-fg">h5py.h5f.open</span><span class="ansi-blue-intense-fg ansi-bold">()</span>

<span class="ansi-red-intense-fg ansi-bold">FileNotFoundError</span>: [Errno 2] Unable to open file (unable to open file: name = &#39;AnatelDB.mat&#39;, errno = 2, error message = &#39;No such file or directory&#39;, flags = 0, o_flags = 0)</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import matplotlib.pyplot as plt</span>


<span class="c1"># ax = sns.countplot(x=&quot;Num_Serviço&quot;, data=base)</span>

<span class="c1"># plt.rcParams[&quot;figure.figsize&quot;] = [30, 20]</span>
<span class="c1"># plt.rcParams[&quot;figure.autolayout&quot;] = True</span>

<span class="c1"># for p in ax.patches:</span>
<span class="c1">#     ax.annotate(&#39;{:.1f}&#39;.format(int(p.get_height())), (p.get_x()+0.05, p.get_height()+0.02))</span>
    
<span class="c1"># plt.title(f&quot;Total de Entidades: {base.shape[0]}&quot;)</span>
<span class="c1"># plt.xlabel(&quot;Código Serviço&quot;)</span>

<span class="c1"># plt.savefig(&quot;Stats.png&quot;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">read_base</span><span class="p">(</span><span class="n">pasta</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequência</th>
      <th>Num_Serviço</th>
      <th>Status</th>
      <th>Classe</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Número_da_Estação</th>
      <th>Município</th>
      <th>UF</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Validade_RF</th>
      <th>Num_Ato</th>
      <th>Data_Ato</th>
      <th>Fonte</th>
      <th>Classe_Emissão</th>
      <th>Largura_Emissão</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0280</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>FURNAS CENTRAIS ELETRICAS S A</td>
      <td>01030052263</td>
      <td>1557670</td>
      <td>Nova Iguaçu</td>
      <td>RJ</td>
      <td>-22.662777</td>
      <td>-43.476387</td>
      <td>2033-08-17</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>J9E</td>
      <td>8K00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0285</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>COMPANHIA DE GERAÇÃO E TRANSMISSÃO DE ENERGIA ...</td>
      <td>50420217282</td>
      <td>1494686</td>
      <td>Joinville</td>
      <td>SC</td>
      <td>-26.292500</td>
      <td>-48.887222</td>
      <td>2025-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>R3E</td>
      <td>2K50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0300</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>FURNAS CENTRAIS ELETRICAS S A</td>
      <td>01030052263</td>
      <td>859966</td>
      <td>Araporã</td>
      <td>MG</td>
      <td>-18.410000</td>
      <td>-49.099998</td>
      <td>2033-08-17</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>J3E</td>
      <td>1K00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0300</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>FURNAS CENTRAIS ELETRICAS S A</td>
      <td>01030052263</td>
      <td>859753</td>
      <td>Campinas</td>
      <td>SP</td>
      <td>-22.774166</td>
      <td>-47.004444</td>
      <td>2033-08-17</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>J3E</td>
      <td>1K00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0300</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>FURNAS CENTRAIS ELETRICAS S A</td>
      <td>01030052263</td>
      <td>1557823</td>
      <td>São Paulo</td>
      <td>SP</td>
      <td>-23.441668</td>
      <td>-46.590832</td>
      <td>2033-08-17</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>J3E</td>
      <td>1K00</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequência&#39;</span><span class="p">,</span> <span class="s1">&#39;Num_Serviço&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Classe&#39;</span><span class="p">,</span> <span class="s1">&#39;Fistel&#39;</span><span class="p">,</span> <span class="s1">&#39;Número_da_Estação&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Classe_Emissão&#39;</span><span class="p">,</span> <span class="s1">&#39;Largura_Emissão&#39;</span><span class="p">]</span>
<span class="c1"># double = base.duplicated(subset=subset, keep=False)</span>
<span class="c1"># base[double]</span>

<span class="n">base</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(881692, 17)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># double = base.duplicated(subset=subset, keep=&#39;first&#39;)</span>
<span class="c1"># base[double]</span>

<span class="n">base</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># base.shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequência</th>
      <th>Num_Serviço</th>
      <th>Status</th>
      <th>Classe</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Número_da_Estação</th>
      <th>Município</th>
      <th>UF</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Validade_RF</th>
      <th>Num_Ato</th>
      <th>Data_Ato</th>
      <th>Fonte</th>
      <th>Classe_Emissão</th>
      <th>Largura_Emissão</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26</th>
      <td>0.038</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>756830</td>
      <td>Piraí</td>
      <td>RJ</td>
      <td>-22.629444</td>
      <td>-43.895832</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>N0N</td>
      <td>1K00</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.040</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>758124</td>
      <td>Petrópolis</td>
      <td>RJ</td>
      <td>-22.433332</td>
      <td>-43.166668</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>A3E</td>
      <td>5K00</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.040</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>758051</td>
      <td>Carmo</td>
      <td>RJ</td>
      <td>-21.840000</td>
      <td>-42.570000</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>N0N</td>
      <td>1K00</td>
    </tr>
    <tr>
      <th>58</th>
      <td>0.044</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>814180</td>
      <td>Volta Redonda</td>
      <td>RJ</td>
      <td>-22.513611</td>
      <td>-44.089722</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>A3E</td>
      <td>5K00</td>
    </tr>
    <tr>
      <th>62</th>
      <td>0.045</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>749680</td>
      <td>Rio de Janeiro</td>
      <td>RJ</td>
      <td>-22.966667</td>
      <td>-43.233334</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>A3E</td>
      <td>5K00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>883461</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1007302558</td>
      <td>Ribeirão das Neves</td>
      <td>MG</td>
      <td>-19.768250</td>
      <td>-44.082527</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>883467</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005319658</td>
      <td>Uberlândia</td>
      <td>MG</td>
      <td>-18.942499</td>
      <td>-48.300556</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>883481</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005325984</td>
      <td>Araxá</td>
      <td>MG</td>
      <td>-19.582222</td>
      <td>-46.953888</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>883514</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1008765390</td>
      <td>Aparecida de Goiânia</td>
      <td>GO</td>
      <td>-16.805166</td>
      <td>-49.329556</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>883530</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabará</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
  </tbody>
</table>
<p>260770 rows × 17 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">Número_da_Estação</span> <span class="o">==</span> <span class="mi">1005304065</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequência</th>
      <th>Num_Serviço</th>
      <th>Status</th>
      <th>Classe</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Número_da_Estação</th>
      <th>Município</th>
      <th>UF</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Validade_RF</th>
      <th>Num_Ato</th>
      <th>Data_Ato</th>
      <th>Fonte</th>
      <th>Classe_Emissão</th>
      <th>Largura_Emissão</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>744796</th>
      <td>8118.32</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabará</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>D7W</td>
      <td>29M7</td>
    </tr>
    <tr>
      <th>825221</th>
      <td>19343.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabará</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>D7W</td>
      <td>55M0</td>
    </tr>
    <tr>
      <th>831552</th>
      <td>19453.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabará</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>D7W</td>
      <td>55M0</td>
    </tr>
    <tr>
      <th>865366</th>
      <td>23275.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabará</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>D7W</td>
      <td>56M0</td>
    </tr>
    <tr>
      <th>881466</th>
      <td>82125.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabará</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>G7W</td>
      <td>2G00</td>
    </tr>
    <tr>
      <th>881467</th>
      <td>82125.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabará</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted constants.ipynb.
Converted filter.ipynb.
Converted index.ipynb.
Converted queries.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

